# StyleFrame
_Exporting DataFrame to designed excel file have never been so easy_


A library that wraps pandas and openpyxl and allows easy styling of dataframes in excel
```
$ pip install styleframe
```
You can read the documentation at http://styleframe.readthedocs.org/en/latest/


## Usage Examples

First, let us create a DataFrames that contains data we would like to export to an .xlsx file
```python
import pandas as pd


# kilograms
oecd_meat_consumption_2015_data = {'Poultry': {0: 290115.0208, 1: 975374.02339999995, 2: 223779.09849999996, 3: 190067.10820000002, 4: 17413885.390000001, 5: 13035917.359999999, 6: 528889.03810000001, 7: 1162824.9510000001, 8: 1312841.064, 9: 1937474.9760000003, 10: 173697.09780000002, 11: 62324.100489999997, 12: 812468.02899999998, 13: 112538886.89999999, 14: 1448830.078, 15: 947221.00829999987, 16: 1484794.067, 17: 91712.997439999992, 18: 44997.100830000003, 19: 1476702.0259999998, 20: 36195559.149999999, 21: 137579.99850000002, 22: 49514.999389999997, 23: 630885.98629999999, 24: 18165790.0, 25: 1144178.1340000001, 26: 2076008.057, 27: 4301362.9899999993, 28: 53174.999239999997, 29: 747900.9399, 30: 194427.62580000001, 31: 46832.099909999997, 32: 1960826.7109999999, 33: 1894160.034, 34: 1476085.9380000001, 35: 1262375.0, 36: 68492.10358000001, 37: 3798193.835, 38: 42651430.039999999, 39: 9297191.1980000008, 40: 1799278.902, 41: 2537054.932, 42: 330240.11230000004, 43: 51186.100009999995, 44: 2416564.5949999997, 45: 1428468.9939999999, 46: 123031.99669999999, 47: 1395060.0}, 'Country': {0: 'DZA', 1: 'EGY', 2: 'BGD', 3: 'NGA', 4: 'USA', 5: 'EU28', 6: 'ISR', 7: 'UKR', 8: 'PER', 9: 'IDN', 10: 'GHA', 11: 'ETH', 12: 'KOR', 13: 'WLD', 14: 'COL', 15: 'PAK', 16: 'VNM', 17: 'TZA', 18: 'PRY', 19: 'SAU', 20: 'BRICS', 21: 'CHE', 22: 'ZMB', 23: 'CHL', 24: 'CHN', 25: 'AUS', 26: 'IRN', 27: 'RUS', 28: 'URY', 29: 'THA', 30: 'NZL', 31: 'MOZ', 32: 'JPN', 33: 'ZAF', 34: 'TUR', 35: 'PHL', 36: 'HTI', 37: 'MEX', 38: 'OECD', 39: 'BRA', 40: 'ARG', 41: 'IND', 42: 'KAZ', 43: 'SDN', 44: 'SSA', 45: 'MYS', 46: 'NOR', 47: 'CAN'}, 'Beef and veal': {0: 217649.10890000002, 1: 1319755.9809999999, 2: 203606.09440000003, 3: 432594.02469999995, 4: 11376200.779999999, 5: 7765305.3090000004, 6: 233243.01150000002, 7: 425335.99850000005, 8: 209072.0062, 9: 714666.74800000014, 10: 28736.999510000001, 11: 358476.01319999993, 12: 692506.01370000001, 13: 67451872.469999999, 14: 833751.03760000004, 15: 1706815.9180000001, 16: 1160312.0119999999, 17: 312496.00219999999, 18: 242802.00200000001, 19: 176098.00719999999, 20: 18950964.899999999, 21: 174894.0, 22: 211255.99669999996, 23: 383777.00810000004, 24: 7504176.898000001, 25: 780739.20720000006, 26: 325565.97900000005, 27: 2484727.3500000001, 28: 227362.0148, 29: 169975.0061, 30: 93580.948820000005, 31: 33098.098749999997, 32: 1210444.909, 33: 831317.01659999997, 34: 930437.01170000003, 35: 435957.00070000003, 36: 53112.098690000006, 37: 1587832.4939999999, 38: 26210596.580000002, 39: 7172642.6239999989, 40: 2506635.3739999998, 41: 958101.01320000016, 42: 426485.0159, 43: 359519.10400000005, 44: 4240313.8280000007, 45: 247027.00809999998, 46: 89744.0, 47: 891891.88659999997}, 'Pork': {0: 191.10000100000002, 1: 529.99997100000007, 2: 105.999999, 3: 258308.10550000001, 4: 9344467.5269999988, 5: 21370577.039999999, 6: 17014.999390000001, 7: 790021.97270000016, 8: 132518.00539999999, 9: 750466.97999999998, 10: 25902.099610000001, 11: 1870.0000050000001, 12: 1830709.996, 13: 117567871.40000001, 14: 314387.08500000002, 15: 0.90000000000000002, 16: 3491675.7810000004, 17: 16323.999400000002, 18: 178790.0085, 19: 9863.9993670000003, 20: 62634592.460000001, 21: 246915.00209999998, 22: 31774.000169999999, 23: 403015.99119999999, 24: 55690637.679999992, 25: 622293.70429999998, 26: 15.899866999999999, 27: 3363500.3149999999, 28: 62748.096469999997, 29: 951877.07520000008, 30: 105248.2561, 31: 138782.10450000002, 32: 2427993.3560000001, 33: 237262.00870000001, 34: 4452.998638, 35: 1837900.8789999997, 36: 44201.099400000006, 37: 1876143.3379999998, 38: 39103655.990000002, 39: 2986400.4380000001, 40: 458763.39720000001, 41: 356792.02270000003, 42: 111872.0932, 43: 201.00000500000002, 44: 1371406.2980000002, 45: 240856.00279999999, 46: 129270.9979, 47: 725552.78000000003}, 'Sheep': {0: 318328.09449999995, 1: 133330.0018, 2: 212894.10399999999, 3: 487278.10669999995, 4: 148525.48280000003, 5: 1059098.629, 6: 16950.09995, 7: 19156.999590000003, 8: 43533.100129999999, 9: 117843.9941, 10: 46804.000850000004, 11: 148776.00100000002, 12: 9004.0000129999989, 13: 14256899.209999999, 14: 11090.00015, 15: 451905.9143, 16: 11569.09943, 17: 65051.10168, 18: 3986.9999889999995, 19: 198805.1605, 20: 5815934.3409999991, 21: 12560.999969999999, 22: 10050.99964, 23: 8397.8996279999992, 24: 4637000.0, 25: 202196.1018, 26: 291732.08619999996, 27: 185388.19770000002, 28: 22137.998580000003, 29: 3210.0000380000001, 30: 22452.704999999998, 31: 25152.10152, 32: 22004.550330000002, 33: 190088.98930000002, 34: 366735.99239999999, 35: 57020.09964, 36: 6777.1000859999995, 37: 73965.94958, 38: 2002995.1899999999, 39: 92944.153090000007, 40: 57934.093570000005, 41: 710513.00049999997, 42: 161339.99630000003, 43: 477985.0159, 44: 2192002.9199999999, 45: 29180.999759999999, 46: 27734.000240000001, 47: 33368.7785}}
# percentages
oecd_meat_consumption_2015_kg_per_capita_data = {'Poultry': {0: 37.111328990408524, 1: 45.17754506863271, 2: 37.375843512693862, 3: 15.200394960131314, 4: 49.904730833101723, 5: 33.242962963042991, 6: 70.853455288119363, 7: 52.366194866866678, 8: 80.044422885936257, 9: 58.90789168594516, 10: 65.22150419629979, 11: 12.517167498445167, 12: 27.127445196124299, 13: 39.534691197461662, 14: 60.32286852430294, 15: 34.359162073517155, 16: 76.485457987378211, 17: 21.846338710433688, 18: 11.232566229306618, 19: 80.94497448266425, 20: 32.144357604050583, 21: 19.358897484276572, 22: 48.463342291710362, 23: 23.249479958925299, 24: 45.422003576500408, 25: 26.926574331070412, 26: 79.034019117555644, 27: 45.543463536685934, 28: 17.054924444432846, 29: 43.230579583519919, 30: 50.552160024996191, 31: 21.160007486624846, 32: 38.464399914463179, 33: 64.082293681575052, 34: 57.060267813140662, 35: 38.30919011680502, 36: 43.710260519909596, 37: 42.581671830894258, 38: 42.25882754189093, 39: 58.647466688875433, 40: 35.510112996963151, 41: 6.2779581445828327, 42: 26.27526290203469, 43: 55.870962375394676, 44: 52.400141804857398, 45: 50.164117094830615}, 'Country': {0: 'DZA', 1: 'EGY', 2: 'BGD', 3: 'NGA', 4: 'USA', 5: 'EU28', 6: 'ISR', 7: 'UKR', 8: 'PER', 9: 'IDN', 10: 'GHA', 11: 'ETH', 12: 'KOR', 13: 'WLD', 14: 'COL', 15: 'PAK', 16: 'MYS', 17: 'TZA', 18: 'PRY', 19: 'SAU', 20: 'BRICS', 21: 'ZMB', 22: 'CHL', 23: 'CHN', 24: 'AUS', 25: 'VNM', 26: 'IRN', 27: 'RUS', 28: 'URY', 29: 'THA', 30: 'NZL', 31: 'MOZ', 32: 'JPN', 33: 'ZAF', 34: 'TUR', 35: 'PHL', 36: 'HTI', 37: 'OECD', 38: 'ARG', 39: 'IND', 40: 'KAZ', 41: 'SDN', 42: 'SSA', 43: 'MEX', 44: 'BRA', 45: 'CAN'}, 'Beef and veal': {0: 22.146676059717134, 1: 48.625093507475896, 2: 27.050644937189698, 3: 27.519705999985007, 4: 25.933351837272053, 5: 15.751866793876456, 6: 24.855383953463488, 7: 15.236463806582183, 8: 10.139818461889725, 9: 17.284480116091895, 10: 8.5833147280056341, 11: 57.269779839205178, 12: 18.392532466579965, 13: 18.848861081792357, 14: 27.613171296856304, 15: 49.24853258618996, 16: 10.52126258003501, 17: 59.211710716330586, 18: 48.212770233174481, 19: 7.6783309819966137, 20: 13.387397420592107, 21: 65.700436589677238, 22: 23.450753529041229, 23: 7.6397189998388839, 24: 24.654375166268505, 25: 16.738056802734103, 26: 9.8591486941719833, 27: 20.927341892004314, 28: 58.006356117312372, 29: 7.8153316493892806, 30: 19.35461586811201, 31: 11.895716371151266, 32: 18.887746398126119, 33: 22.371928219869389, 34: 28.610438131013044, 35: 10.523824809341045, 36: 26.961976180567401, 37: 20.815238223714964, 38: 46.830143433869161, 39: 17.617571941503112, 40: 36.478869952393126, 41: 35.075487484168534, 42: 36.674316601049334, 43: 18.579288592903534, 44: 32.156980356567601, 45: 25.511022598251348}, 'Pork': {0: 0.021667507258650739, 1: 0.021759015828386821, 2: 0.015692388206396544, 3: 18.310401634332223, 4: 23.736272846372664, 5: 48.304357133497206, 6: 2.020413848773253, 7: 31.5346326513734, 8: 7.1615288525632881, 9: 20.224644504390703, 10: 8.6207519312710854, 11: 0.33289217275484723, 12: 54.17938833237141, 13: 36.608026871459224, 14: 11.602221683340137, 15: 2.8969476927404948e-05, 16: 11.430821907314179, 17: 3.4465634360690132, 18: 39.559394051908264, 19: 0.47924985095000855, 20: 49.303261268841347, 21: 11.011022907043747, 22: 27.440795089405817, 23: 63.176138216806471, 24: 21.896766188097263, 25: 56.125564541330917, 26: 0.00053652497731376835, 27: 31.566277086687915, 28: 17.838354629435901, 29: 48.768542588204518, 30: 24.255407944922919, 31: 55.579877420132533, 32: 42.216203192173786, 33: 7.1147806029070182, 34: 0.15257615038664984, 35: 49.436600805855939, 36: 25.002756551090599, 37: 34.603370738699795, 38: 9.550357887723413, 39: 7.3104894233268896, 40: 10.662423439110587, 41: 0.021851152363483638, 42: 13.216812593048216, 43: 24.461719045522269, 44: 14.919032872850879, 45: 23.124972623367366}, 'Sheep': {0: 40.720327442615698, 1: 6.1756024080630052, 2: 35.557819161910054, 3: 38.969497405551465, 4: 0.42564448325356713, 5: 2.7008131095833572, 6: 2.2707469096438984, 7: 0.86270867517774419, 8: 2.6542297996107242, 9: 3.5829836935722281, 10: 17.574429144423494, 11: 29.880160489594811, 12: 0.30063400492433051, 13: 5.0084208492867583, 14: 0.46173849550062895, 15: 16.392276370815946, 16: 1.5624575252725943, 17: 15.495387137166704, 18: 0.99526948561065809, 19: 10.897444684389143, 20: 5.1649837065159723, 21: 3.9296430190024432, 22: 0.64510908984257498, 23: 5.9346628244293385, 24: 8.0268550691338341, 25: 0.20980432486456785, 26: 11.106295663295064, 27: 1.9629174846218451, 28: 7.1003648088188909, 29: 0.18554617888627459, 30: 5.8378161619688873, 31: 11.364398722091364, 32: 0.43165049523690474, 33: 6.4309974956485325, 34: 14.176717905459638, 35: 1.730384267998009, 36: 4.3250067484324157, 37: 1.999719206690971, 38: 1.3606711365165001, 39: 16.42447194629457, 40: 17.348593611533136, 41: 58.624703218885145, 42: 23.833607903867765, 43: 1.0880299861795357, 44: 0.5238449657241192, 45: 1.1998876835506795}}

columns = ['Country', 'Beef and veal', 'Pork', 'Poultry', 'Sheep']

oecd_meat_consumption_2015_df = pd.DataFrame(data=oecd_meat_consumption_2015_data, 
                                             columns=columns)
oecd_meat_consumption_2015_kg_per_capita_df = pd.DataFrame(data=oecd_meat_consumption_2015_kg_per_capita_data, 
                                                           columns=columns)                                             

most_popular_meat_kind_in_each_country = oecd_meat_consumption_2015_df[columns[1:]].idxmax(axis=1)

oecd_meat_consumption_2015_df['Mean'] = oecd_meat_consumption_2015_df.mean(axis=1)
oecd_meat_consumption_2015_df['Sum'] = oecd_meat_consumption_2015_df[columns[1:]].sum(axis=1)
```

Now, once we have the DataFrames ready, lets create a StyleFrame object
```python
from StyleFrame import StyleFrame

oecd_meat_consumption_2015_sf = StyleFrame(oecd_meat_consumption_2015_df)
oecd_meat_consumption_2015_kg_per_capita_sf = StyleFrame(oecd_meat_consumption_2015_kg_per_capita_df)

# it is also possible to directly initiate StyleFrame
sf = StyleFrame({'Col A': [1, 20, -3],
                 'Col B': [15, 3, 116],
                 'Col C': [33, -6, 9]})
```

The StyleFrame object will auto-adjust the columns width and the rows height
but they can be changed manually
```python
# using dict of tuple of columns as key and width as value
oecd_meat_consumption_2015_sf.set_column_width_dict(col_width_dict={
    ('Country', ): 13,
    ('Beef and veal', 'Pork', 'Poultry', 'Sheep'): 15.3,
    ('Sum', 'Mean'): 30
})

# using list of columns
oecd_meat_consumption_2015_kg_per_capita_sf.set_column_width(columns=columns, width=16)


# excel rows starts from 1
# row number 1 is the headers
# len of StyleFrame (same as DataFrame) does not count the headers row
all_rows = lambda x: tuple(i for i in xrange(1, len(x) + 2))

oecd_meat_consumption_2015_sf.set_row_height_dict(row_height_dict={
    (1, ): 45,  # the headers row
    all_rows(oecd_meat_consumption_2015_sf)[1:]: 25
})

oecd_meat_consumption_2015_kg_per_capita_sf.set_row_height(rows=all_rows(oecd_meat_consumption_2015_kg_per_capita_sf),
                                                           height=30)
```

Next, let's change the background color of the maximum values to red and the font to white
we will also protect those cells and prevent the ability to change their values
```python
from StyleFrame import Styler, utils

style = Styler(bg_color=utils.colors.red, bold=True, font_color=utils.colors.white, protection=True,
               underline=utils.underline.double, number_format=utils.number_formats.thousands_comma_sep)
for row_index, col_name in most_popular_meat_kind_in_each_country.iteritems():
    oecd_meat_consumption_2015_sf[col_name][row_index].style = style.create_style()
```

And change the font and the font size of Sum and Mean columns
```python
sf.apply_column_style(cols_to_style=['Sum', 'Mean'],
                      font_color='#40B5BF',
                      font_size=18,
                      bold=True,
                      style_header=True)
```

Finally, let's export to Excel but not before we use more of StyleFrame's features:
- Change the page writing side
- Freeze rows and columns
- Add filters to headers

```python
sf.to_excel('data.xlsx',
            right_to_left=False,
            columns_and_rows_to_freeze='B2', # will freeze the rows above 2 (=row 1 only) and columns that before column 'B' (=col A only)
            row_to_add_filters=0).save()
```

**_the result:_**
<img src="https://s32.postimg.org/gh2d7ruet/image.png">
